# Quá trình xác định các dịch vụ không an toàn mà không xâm phạm là một bước quan trọng trong kiểm thử xâm nhập. Nó cho phép người kiểm thử duy trì trạng thái ẩn danh và kín đáo trong giai đoạn trinh sát và liệt kê, tránh những tiếng ồn hoặc cảnh báo không cần thiết có thể được kích hoạt bởi các kỹ thuật tấn công mạnh hơn.

<img width="918" height="937" alt="image" src="https://github.com/user-attachments/assets/dd72e7c5-a359-4f9b-a1e3-badebfdc1143" />

<img width="893" height="415" alt="image" src="https://github.com/user-attachments/assets/b1cdc75a-3145-4bf0-9ec7-cb32cc4b90ef" />

- Nmap chạy với tính năng phát hiện phiên bản (-sV) và các tập lệnh NSE mặc định (-sC) trên dịch vụ Fp (port 21)

<img width="930" height="424" alt="image" src="https://github.com/user-attachments/assets/38c98573-6cbb-4b2a-9efd-22cf8b7e90ae" />

- Lệnh NetExec (trước đây là CrackMapExec) này cố gắng xác thực với dịch vụ SMB trên máy chủ đích bằng thông tin xác thực phiên null (tên người dùng và mật khẩu trống).

<img width="425" height="105" alt="image" src="https://github.com/user-attachments/assets/14d7cd7f-203f-4a17-84a6-01f4da4cdb99" />

=> Do máy chủ đích không có dịch vụ SMB chạy (cổng 445 hoặc 139 không mở) => Lệnh này không trả về gì.

- Truy vấn chính sách mật khẩu của hệ thống đích:

`
nxc smb 192.168.22.130 -u '' -p '' --pass-pol
`

<img width="902" height="414" alt="image" src="https://github.com/user-attachments/assets/32e7b0cb-a94e-4fdd-8ad0-f5160f7d2e16" />

# advanced:

- Quét các lỗ hổng đã biết:

<img width="862" height="710" alt="image" src="https://github.com/user-attachments/assets/226b3ec4-6a85-4c8c-82ce-261a90831d00" />

<img width="656" height="804" alt="image" src="https://github.com/user-attachments/assets/050864bb-758a-480b-883f-1e27d935d2c4" />

- Thực thi các tập lệnh không xâm phạm:

<img width="658" height="863" alt="image" src="https://github.com/user-attachments/assets/2880b0af-1770-4c09-85e6-0c7a308d1a06" />

=> Hiện thêm các script an toàn mà nmap đã chạy thêm để thu thập thông tin từ dịch vụ.

- Kiểm tra đăng nhập FTP ẩn danh. Nó sẽ thửu đăng nhập vào dịch vụ FTP bằng user ẩn danh và báo kết qả (có cho phép hay không, thư mục gốc...)

<img width="641" height="696" alt="image" src="https://github.com/user-attachments/assets/f69113f8-6243-49ad-b019-3d78308e74b0" />

=> Server có cho phép Ẩn danh đăng nhập. Còn nếu không cho phép ẩn danh đăng nhập thì:

<img width="652" height="367" alt="image" src="https://github.com/user-attachments/assets/be39fa1d-4a06-4909-9f86-5f5b581ca371" />

Ngoài ra còn nhiều cách trả về khác.

- Phát hiện lỗ hổng Backdoor với FTPd 2.3.4: Kiểm tra lỗ hổng vsftpd 2.3.4 backdoor (viến thể backdoor cũ nổi tiếng). Sẽ báo nếu target có bằng chứng của phiên bản bị backdoor (thường liên quan tới build vsftpd 2.3.4 với backdoor mở một shell/listener).

<img width="658" height="768" alt="image" src="https://github.com/user-attachments/assets/3393e8a7-3b73-4f6e-99fb-5ada55775a3b" />

=> Có lỗ hổng Backdoor FTPd 2.3.4. Còn nếu không sẽ hiện output:

<img width="581" height="235" alt="image" src="https://github.com/user-attachments/assets/939d5582-2faf-4d71-b0de-9020c8e7f558" />

- Phát hiện lỗ hổng bảo mật của Sâu Conficker:

`
nmap --script smb-vuln-conficker <target>
`

<img width="641" height="335" alt="image" src="https://github.com/user-attachments/assets/b7b99087-e098-4a54-8fb7-ae42f255223b" />

=> Không phát hiện.

- Liệt kê shares (shares có thể chứa dữ liệu nhạy cảm - kiểm tra quyền truy cập):

<img width="626" height="331" alt="image" src="https://github.com/user-attachments/assets/a191150c-20e1-4613-ba20-e04118509894" />

- Liệt kê người dùng SMB:

<img width="638" height="398" alt="image" src="https://github.com/user-attachments/assets/51a856d0-e173-4452-a782-ccf33d5ab546" />

- Liệt kê các phương thức xác thực ssh được hỗ trợ: Biết phương thức auth giúp xác định tấn công hợp lệ (khuyến nghị: disable password auth, bật key-only)

<img width="637" height="376" alt="image" src="https://github.com/user-attachments/assets/6c03a6ba-405b-4a82-b0f6-b7c42ca12be6" />

- Lấy khóa máy chủ SSH để lấy dấu vân tay: Lấy fingerprint để đối chiếu => Phát hiện MITM hoặc inventory,

<img width="645" height="340" alt="image" src="https://github.com/user-attachments/assets/51d86426-ccc7-4319-bc3e-b27d55ea77d0" />

- Tấn công DNS để tìm tên miền phụ:

<img width="667" height="391" alt="image" src="https://github.com/user-attachments/assets/1f758aa9-3b05-4dd0-97d8-47b4424e29e1" />

- Thu thập thông tin hệ thống thông qua SNMP (rủi ro nếu public community truy cập)

<img width="663" height="333" alt="image" src="https://github.com/user-attachments/assets/65a80f35-04fd-476a-9958-10b94edde9a1" />

- Liệt kê các tiến trình đang chạy qua SNMP:

<img width="629" height="350" alt="image" src="https://github.com/user-attachments/assets/598f00ab-cc96-4499-b3af-f463ca98e133" />

- Truy xuất thông tin chứng chỉ SSL/TLS:

<img width="635" height="362" alt="image" src="https://github.com/user-attachments/assets/7032c9b2-9e1e-4cf3-952f-7acf4c42d9bd" />

- Phát hiện dịch vụ và phiên bản VNC. Nếu "None" thì khoogn auth - rủi ro lớn.

<img width="656" height="359" alt="image" src="https://github.com/user-attachments/assets/1562640f-c3ef-4388-9cc0-281171979311" />

- Kiểm tra cài đặt mã hóa RDP:

<img width="615" height="335" alt="image" src="https://github.com/user-attachments/assets/0359884a-4041-444e-b1a9-e76b567522e7" />

- Thu thập thông tin từ Microsoft SQL Server:

<img width="640" height="353" alt="image" src="https://github.com/user-attachments/assets/f1714260-a56c-451c-bd71-539ce5eed879" />

- Thu thập thông tin về máy chủ MySQL:

<img width="642" height="329" alt="image" src="https://github.com/user-attachments/assets/aec37746-9add-4678-8916-e05a2bb5a02e" />

- Thực hiện tìm kiếm LDAP theo dịch vụ thư mục:

<img width="655" height="471" alt="image" src="https://github.com/user-attachments/assets/f5d8e208-c5eb-4a20-9412-52da120a5761" />

=> LAP (Light Directory Access Protocol): giao thức ứng dụng tiêu chuẩn để truy cập và quản lý các dịch vụ thư mục trên mạng. LDAP search là thao tác hỏi một server LDAP (dịch vụ thư mục) để lấy các entry (đối tượng) nằm trong cây thư mục. 











- 


